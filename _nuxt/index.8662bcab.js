import{H as F,_ as H}from"./TheContainer.58caa0a4.js";import{_ as R}from"./AppTag.vue.f92c88d9.js";import{f as D,r as A,o as n,c as a,a as t,m as j,v as q,g as e,n as E,q as w,t as s,j as I,A as M,b as y,w as v,h as C,i as p,d as f,F as T,s as $,x as N}from"./entry.00d493d3.js";import{t as P,o as O,s as W,u as G,a as J}from"./vee-validate.esm.ac5e120a.js";import{a as k}from"./index.e0cfa627.js";import{_ as Q}from"./ArticleComment.vue.53027f29.js";import{u as S}from"./fetch.e32eb309.js";import{a as X}from"./auth.3873e1eb.js";import"./UserAvatar.vue.f03bb6f7.js";const K=(h,_,r)=>$fetch(`${k}/todos/${_}/comments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Token ${encodeURIComponent(h)}`},body:{comment:{body:r}}}),Y={class:"w-full p-0 m-0 border-0"},Z={class:"py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700"},tt={class:"text-red-500"},et=["disabled"],ot=D({__name:"TodosCommentForm",props:{author:{type:Object,required:!0},todoId:{type:Number,required:!0}},emits:["create:todoComment"],setup(h,{emit:_}){const r=h,d=A(!1),l=P(O({body:W().nonempty("This is required")})),{handleSubmit:x,errors:o}=G({validationSchema:l}),{value:m}=J("body"),b=x(async c=>{d.value=!0;try{await K(r.author.token,r.todoId,c.body),_("create:todoComment")}catch(i){alert(i)}finally{d.value=!1}});return(c,i)=>(n(),a("form",{onSubmit:i[1]||(i[1]=(...u)=>e(b)&&e(b)(...u))},[t("fieldset",Y,[t("div",Z,[t("div",null,[j(t("textarea",{"onUpdate:modelValue":i[0]||(i[0]=u=>E(m)?m.value=u:null),name:"body",placeholder:"Write a comment...",rows:"4",class:w(["px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800",{"opacity-50 pointer-events-none":e(d)}])},null,2),[[q,e(m)]]),t("span",tt,s(e(o).body),1)])]),t("button",{disabled:e(d),type:"submit",class:w(["inline-flex items-center py-2.5 px-4 text-xs font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800",{"bg-gray-300 cursor-not-allowed":e(d)}])}," Опубликовать ",10,et)])],32))}}),st={class:"bg-white dark:bg-gray-900"},nt={key:0,class:"mb-8"},at={key:1,class:"py-8 px-4 mx-auto max-w-2xl lg:py-16"},dt={class:"mb-4 text-xl font-extrabold leading-none text-gray-900 md:text-2xl dark:text-white"},rt=["href"],it=["data-src","src"],lt={class:"mb-2 text-xl font-semibold leading-none text-gray-900 md:text-2xl dark:text-white"},mt=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Описание",-1),ct={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},ut={class:"flex items-center space-x-6"},gt=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Дата создания",-1),ht={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},_t=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Дата обновления",-1),xt={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},bt=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Начать с :",-1),yt={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},pt=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Завершить до :",-1),ft={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},kt={class:"flex items-center space-x-6"},wt=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Задача выполнена",-1),vt={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},Ct=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Задача удалена",-1),Tt={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},$t=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Задача активная",-1),St={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},Dt={class:"flex items-center space-x-6"},At=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Статус",-1),Vt={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},Lt=t("dt",{class:"mb-2 font-semibold leading-none text-gray-900 dark:text-white"},"Приоритет",-1),Ut={class:"mb-4 font-light text-gray-500 sm:mb-5 dark:text-gray-400"},zt={key:0,class:"mb-12 space-x-1"},Bt=t("div",{class:"flex items-center space-x-4"},[t("button",{type:"button",class:"text-white inline-flex items-center bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800"},[t("svg",{"aria-hidden":"true",class:"mr-1 -ml-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z"}),t("path",{"fill-rule":"evenodd",d:"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z","clip-rule":"evenodd"})]),f(" Изменить ")]),t("button",{type:"button",class:"inline-flex items-center text-white bg-red-600 hover:bg-red-700 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-500 dark:hover:bg-red-600 dark:focus:ring-red-900"},[t("svg",{"aria-hidden":"true",class:"w-5 h-5 mr-1.5 -ml-1",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})]),f(" Удалить ")])],-1),Ft=t("hr",{class:"my-4 border-t border-gray-200"},null,-1),Ht={key:1,class:"comments w-full md:w-2/3 md:mx-auto mb-12 mt-12"},Rt={key:2,class:"comments w-full md:w-2/3 md:mx-auto"},jt={key:3},Jt=D({__name:"index",setup(h){const r=I().params.id,d=X(),l=A(null),x=()=>{const{data:c}=S(new URL(`${k}/todos/${r}/comments`).toString(),{method:"GET"},"$LVWWOXqti8");N(()=>{l.value=c.value})};x();const{data:o,pending:m}=S(new URL(`${k}/todos/${r}`).toString(),{method:"GET"},"$koTPjQQPDV"),b=()=>{x()};return(c,i)=>{const u=F,V=M("TodoJumbotron"),L=R,U=ot,z=Q,B=H;return n(),a("div",null,[y(u,null,{default:v(()=>[t("title",null,`\r
        `+s(e(o)&&e(o).todo?e(o).todo.title:"Loading the todo...")+`\r
      `,1)]),_:1}),e(o)&&e(o).todo?(n(),C(V,{key:0,todo:e(o).todo},null,8,["todo"])):p("",!0),y(B,null,{default:v(()=>[t("section",st,[e(m)?(n(),a("p",nt,"Loading the todo...")):e(o)&&e(o).todo?(n(),a("div",at,[t("p",dt,[t("a",{href:`/@${encodeURIComponent(e(o).todo.author.username)}`},[t("img",{"data-src":e(o).todo.author.image,src:e(o).todo.author.image,alt:"изображение профиля автора",class:"inline-block align-middle h-8 w-8 rounded-full ring-2 ring-gray-300 dark:ring-gray-500"},null,8,it),f(" @"+s(e(o).todo.author.username),1)],8,rt)]),t("h2",lt,s(e(o).todo.title),1),t("dl",null,[mt,t("dd",ct,s(e(o).todo.body),1)]),t("dl",ut,[t("div",null,[gt,t("dd",ht,s(new Date(e(o).todo.createdAt).toDateString()),1)]),t("div",null,[_t,t("dd",xt,s(new Date(e(o).todo.updatedAt).toDateString()),1)]),t("div",null,[bt,t("dd",yt,s(new Date(e(o).todo.startTimedAt).toDateString()),1)]),t("div",null,[pt,t("dd",ft,s(new Date(e(o).todo.endTimedAt).toDateString()),1)])]),t("dl",kt,[t("div",null,[wt,t("dd",vt,s(e(o).todo.is_complete),1)]),t("div",null,[Ct,t("dd",Tt,s(e(o).todo.is_deleted),1)]),t("div",null,[$t,t("dd",St,s(e(o).todo.is_active),1)])]),t("dl",Dt,[t("div",null,[At,t("dd",Vt,s(e(o).todo.status),1)]),t("div",null,[Lt,t("dd",Ut,s(e(o).todo.priority),1)])]),e(o).todo.tagList?(n(),a("ul",zt,[(n(!0),a(T,null,$(e(o).todo.tagList,g=>(n(),a("li",{key:g,class:"inline"},[y(L,{name:g},null,8,["name"])]))),128))])):p("",!0),Bt,Ft,e(o)&&e(o).todo&&e(d).isAuthenticated&&e(d).currentUser?(n(),a("div",Ht,[y(U,{author:e(d).currentUser,"todo-id":e(o).todo.id,"onCreate:todoComment":b},null,8,["author","todo-id"])])):p("",!0),e(l)&&e(l).comments.length>0?(n(),a("div",Rt,[(n(!0),a(T,null,$(e(l).comments,g=>(n(),C(z,{key:g.id,class:"comment mb-4","article-comment":g},null,8,["article-comment"]))),128))])):(n(),a("p",jt,"There are no comments yet..."))])):p("",!0)])]),_:1})])}}});export{Jt as default};
