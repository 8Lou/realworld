import{_ as T,H as D}from"./TheContainer.58caa0a4.js";import{_ as q}from"./UserAvatar.vue.f03bb6f7.js";import{_ as j}from"./nuxt-link.ce1698c8.js";import{_ as H}from"./FollowButton.vue.7d684a4b.js";import{_ as J}from"./FavoriteButton.vue.3a5600b7.js";import{a as F}from"./auth.3873e1eb.js";import{f as P,_ as z}from"./ArticleComment.vue.53027f29.js";import{f as x,o as a,c as n,b as l,w as b,a as r,t as p,d as G,g as e,i as f,r as U,m as I,v as M,n as O,q as k,j as W,h as w,F as $,s as C,x as K}from"./entry.00d493d3.js";import{_ as Q}from"./AppTag.vue.f92c88d9.js";import{t as X,o as Y,s as Z,u as ee,a as te}from"./vee-validate.esm.ac5e120a.js";import{c as A}from"./article.b7024956.js";import{u as S}from"./fetch.e32eb309.js";import{a as L}from"./index.e0cfa627.js";const oe={class:"p-8 overflow-auto text-white bg-zinc-700 shadow-inner mt-10"},ae={class:"inline-block mb-2 text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white"},re={class:"ml-2 inline-block align-middle"},ne={class:"list-inside"},se={class:"text-sm font-medium"},le={class:"text-xs text-gray-400"},ie={key:0,class:"ml-4 inline-block align-middle"},ce=x({__name:"ArticleJumbotron",props:{article:{}},setup(v){const y=F();return(o,s)=>{const i=q,d=j,t=H,m=J,_=T;return a(),n("div",oe,[l(_,null,{default:b(()=>{var c;return[r("h1",ae,p(o.article.title),1),l(i,{image:o.article.author.image,class:"w-8 h-8"},null,8,["image"]),r("div",re,[r("ul",ne,[r("li",se,[l(d,{href:`/@${encodeURIComponent(o.article.author.username)}`,class:"hover:underline"},{default:b(()=>[G(p(o.article.author.username),1)]),_:1},8,["href"])]),r("li",le,p(e(P)(o.article.createdAt)),1)])]),((c=e(y).currentUser)==null?void 0:c.username)!==o.article.author.username?(a(),n("div",ie,[l(t,{username:o.article.author.username,active:o.article.author.following,class:"inline-block align-middle"},null,8,["username","active"]),l(m,{"favorites-count":o.article.favoritesCount,active:o.article.favorited,"article-slug":o.article.slug,text:"Favorite Article",class:"inline-block align-middle ml-1"},null,8,["favorites-count","active","article-slug"])])):f("",!0)]}),_:1})])}}}),me={class:"w-full p-0 m-0 border-0"},ue={class:"py-2 px-4 mb-4 bg-white rounded-lg rounded-t-lg border border-gray-200 dark:bg-gray-800 dark:border-gray-700"},de={class:"text-red-500"},_e=["disabled"],pe=x({__name:"ArticleCommentForm",props:{author:{type:Object,required:!0},articleSlug:{type:String,required:!0}},emits:["create:articleComment"],setup(v,{emit:y}){const o=v,s=U(!1),i=X(Y({body:Z().nonempty("This is required")})),{handleSubmit:d,errors:t}=ee({validationSchema:i}),{value:m}=te("body"),_=d(async c=>{s.value=!0;try{await A(o.author.token,o.articleSlug,c.body),console.log(A),y("create:articleComment")}catch(u){alert(u)}finally{s.value=!1}});return(c,u)=>(a(),n("form",{onSubmit:u[1]||(u[1]=(...h)=>e(_)&&e(_)(...h))},[r("fieldset",me,[r("div",ue,[r("div",null,[I(r("textarea",{"onUpdate:modelValue":u[0]||(u[0]=h=>O(m)?m.value=h:null),name:"body",placeholder:"Write a comment...",rows:"4",class:k(["px-0 w-full text-sm text-gray-900 border-0 focus:ring-0 focus:outline-none dark:text-white dark:placeholder-gray-400 dark:bg-gray-800",{"opacity-50 pointer-events-none":e(s)}])},null,2),[[M,e(m)]]),r("span",de,p(e(t).body),1)])]),r("button",{disabled:e(s),type:"submit",class:k(["inline-flex items-center py-2.5 px-4 text-xs font-medium text-center text-white bg-primary-700 rounded-lg focus:ring-4 focus:ring-primary-200 dark:focus:ring-primary-900 hover:bg-primary-800",{"bg-gray-300 cursor-not-allowed":e(s)}])}," Опубликовать ",10,_e)])],32))}}),he={key:0,class:"mb-8"},ge={key:1},fe={class:"text-lg text-gray-500 xl:mr-64 lg:mb-0 dark:text-gray-400"},ye={key:0,class:"mb-12 space-x-1"},be=r("hr",{class:"my-4 border-t border-gray-200"},null,-1),ve={key:2,class:"comments w-full md:w-2/3 md:mx-auto mb-12 mt-12"},xe={key:3,class:"comments w-full md:w-2/3 md:mx-auto"},ke={key:4},Ve=x({__name:"index",setup(v){const o=W().params.slug,s=F(),i=U(null),d=()=>{const{data:c}=S(new URL(`${L}/articles/${o}/comments`).toString(),{method:"GET"},"$rPLVcLo9iJ");K(()=>{i.value=c.value})};d();const{data:t,pending:m}=S(new URL(`${L}/articles/${o}`).toString(),{method:"GET"},"$9NguAEvfhC"),_=()=>{d()};return(c,u)=>{const h=D,B=ce,E=Q,N=pe,R=z,V=T;return a(),n("div",null,[l(h,null,{default:b(()=>[r("title",null,`\r
        `+p(e(t)&&e(t).article?e(t).article.title:"Loading the article...")+`\r
      `,1)]),_:1}),e(t)&&e(t).article?(a(),w(B,{key:0,article:e(t).article},null,8,["article"])):f("",!0),l(V,null,{default:b(()=>[e(m)?(a(),n("p",he,"Loading the article...")):e(t)&&e(t).article?(a(),n("div",ge,[r("p",fe,p(e(t).article.body),1),e(t).article.tagList?(a(),n("ul",ye,[(a(!0),n($,null,C(e(t).article.tagList,g=>(a(),n("li",{key:g,class:"inline"},[l(E,{name:g},null,8,["name"])]))),128))])):f("",!0)])):f("",!0),be,e(t)&&e(t).article&&e(s).isAuthenticated&&e(s).currentUser?(a(),n("div",ve,[l(N,{author:e(s).currentUser,"article-slug":e(t).article.slug,"onCreate:articleComment":_},null,8,["author","article-slug"])])):f("",!0),e(i)&&e(i).comments.length>0?(a(),n("div",xe,[(a(!0),n($,null,C(e(i).comments,g=>(a(),w(R,{key:g.id,class:"comment mb-4","article-comment":g},null,8,["article-comment"]))),128))])):(a(),n("p",ke,"There are no comments yet..."))]),_:1})])}}});export{Ve as default};
